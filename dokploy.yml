# Configuración para Dokploy
# Este archivo puede ser usado como referencia para configurar el despliegue en Dokploy

name: dela-platform
version: '1.0.0'

# Configuración del repositorio
repository:
  url: https://github.com/Jenaru0/dela-platform.git
  branch: develop

# Configuración del Backend (API) - Nixpacks
api:
  type: nixpacks
  port: 3000
  dockerfile: api/Dockerfile
  build_command: 'npm run build'
  start_command: 'cd api && npm run start:prod'
  health_check: '/health'
  nixpacks_config: nixpacks.toml

  # Variables de entorno requeridas para producción
  environment:
    - DATABASE_URL=postgresql://usuario:password@host:5432/database
    - JWT_SECRET=tu_jwt_secret_super_seguro_de_al_menos_32_caracteres
    - JWT_EXPIRES_IN=7d
    - NODE_ENV=production
    - PORT=3000
    - FRONTEND_URL=https://tu-dominio.com
    - ALLOWED_ORIGINS=https://tu-dominio.com,http://localhost:3000
    - BCRYPT_SALT_ROUNDS=12
    - CORS_ENABLED=true
    - REDIS_URL=redis://localhost:6379
    - SMTP_HOST=smtp.gmail.com
    - SMTP_PORT=587
    - SMTP_USER=tu-email@gmail.com
    - SMTP_PASS=tu-app-password
    - UPLOAD_MAX_SIZE=10485760
    - SESSION_SECRET=tu_session_secret_super_seguro

# Configuración del Frontend (Web)
web:
  type: nextjs
  port: 3000
  dockerfile: web/Dockerfile
  build_command: 'npm run build'
  start_command: 'npm run start'

  # Variables de entorno requeridas para producción
  environment:
    - NEXT_PUBLIC_API_URL=https://api.tu-dominio.com
    - NODE_ENV=production
    - NEXT_PUBLIC_APP_NAME=Dela Platform
    - NEXT_PUBLIC_ENVIRONMENT=production

# Base de datos (si usas Dokploy para la DB)
database:
  type: postgresql
  version: '15'
  database_name: dela_platform

# Dominio y SSL
domain:
  api: api.tu-dominio.com
  web: tu-dominio.com
  ssl: true
